<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>BlackHole by aenima-x</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">BlackHole</h1>
      <h2 class="project-tagline">Monitor all the ssh and sql sessions on your network<br>Centralized ssh/sql session logger, connections and authentication manager</h2>
      <a href="https://github.com/aenima-x/BlackHole" class="btn">View on GitHub</a>
      <a href="https://github.com/aenima-x/BlackHole/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/aenima-x/BlackHole/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="blackhole" class="anchor" href="#blackhole" aria-hidden="true"><span class="octicon octicon-link"></span></a>BlackHole</h1>

<h3>
<a id="what-is-blackhole-and-what-it-can-do" class="anchor" href="#what-is-blackhole-and-what-it-can-do" aria-hidden="true"><span class="octicon octicon-link"></span></a>What is BlackHole and what it can do?</h3>

        <p><img src="https://raw.githubusercontent.com/aenima-x/BlackHole/gh-pages/images/terminal.png"></p>

<p>It's a security tool to keep tracking and monitor all the ssh and sql sessions on your servers.
You will know who is connected to where and see what they are doing in real time.
Identify and keep track of anonymous connections that share a single user.
Use the session logs to do forensics of problems generated after an implementation or deployment done by a user.
Give users access to your platform without handover of any password.
It replaces the shell of the user (in the BlackHole server) giving the user only a menu that offers targets based on his profile.</p>

<p>BlackHole is gonna be the only entry point for all your hosts and databases.</p>

<p><img src="https://raw.githubusercontent.com/aenima-x/BlackHole/gh-pages/images/blackhole-diagram.png"></p>

<h3>
<a id="keeping-track" class="anchor" href="#keeping-track" aria-hidden="true"><span class="octicon octicon-link"></span></a>Keeping track.</h3>

        <p><img src="https://raw.githubusercontent.com/aenima-x/BlackHole/gh-pages/images/sessions.png"></p>
<p>BlackHole gives you a web interface so you can in real time know who is connected to where.
With the possibility of download the log file of that connection so you can see what the user is doing in it.
Also it stores in a database all the information about all the connections established with the targets.</p>

        <p>Including:</p>

        <ul>
            <li>User</li>
            <li>Source IP</li>
            <li>Target destination</li>
            <li>User used to authenticate</li>
            <li>Login date</li>
            <li>Logout date</li>
        </ul>

<h3>
<a id="see-it-in-action" class="anchor" href="#see-it-in-action" aria-hidden="true"><span class="octicon octicon-link"></span></a>See it in action</h3>

<p>Here you can see it in action</p>

<p><iframe width="560" height="315" src="https://www.youtube.com/embed/NSPyeQ6UXgs" frameborder="0" allowfullscreen></iframe></p>

<h3>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h3>

<p>Create the group</p>

<div class="highlight highlight-Bash"><pre>groupadd backhole</pre></div>

<p>Copy to the destination folder, for this example is /opt</p>

<div class="highlight highlight-Bash"><pre>mv BlackHole /opt</pre></div>

<p>Set the permissions</p>

<pre><code>chown -r root:blackhole /opt/BlackHole
</code></pre>

        <p>Install the requirements</p>

<pre><code>pip install -r requirements.txt
</code></pre>
        <p>If you want to connect to databases, you must install the command line clients</p>

<p>Create the database and set the configuration file</p>

<div class="highlight highlight-Bash"><pre><code>mv /opt/BlackHole/blackhole/settings_dev.py /opt/BlackHole/blackhole/settings.py</code></pre></div>
<div class="highlight highlight-Bash"><pre><code>vi /opt/BlackHole/blackhole/settings.py</code></pre></div>

<pre><code>DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'DATABASE_NAME',
        'USER': 'USER',
        'PASSWORD': 'PASSWORD'
     }}
</code></pre>

<p>Define the path for the logs and set it to the "log_path" variable</p>

<p>Create the database</p>

<p><pre><code>/opt/BlackHole/manage.py syncdb</code></pre></p>

<p>To run the admin site you can use the django integrated web server, but it's not recommended for production (you must set DEBUG in settings.py to True, remember set it to False in production).</p>

<div class="highlight highlight-Bash"><pre>/opt/BlackHole/manage.py runserver</pre></div>

<p><strong>IMPORTANT:</strong> Don't forget to have a redis instance running (you can set the ip or hostname un the settings.py file variable called "redis_server")</p>

<p><strong>IMPORTANT:</strong> The user who runs the admin site mast have permissions to access to the logs but also to kill the processes (basically must be root)</p>

<p>You can use nginx + gunicorn or apache, use the gunicorn and nginx example files</p>

<p>You are now ready to create users and start using it.</p>
        <p><pre><code>useradd -s /opt/BlackHole/launcher.py -d /hoem/XXXX -g blackhole USER</code></pre></p>

<p>You must set <strong>/opt/BlackHole/launcher.py</strong> as the shell of the users, and don't forget to set "blackhole" as their main group.</p>

<p>It's recommended to disable SCP and SFTP en the server to avoid any access that its not done using BlackHole.
Also Disable port forwarding in the sshd configuration</p>

<h3>
<a id="setup" class="anchor" href="#setup" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setup</h3>

<p>Here you can see how to setup BlackHole</p>
        <iframe width="560" height="315" src="https://www.youtube.com/embed/trjYvbQE1vY" frameborder="0" allowfullscreen></iframe></a>

<br>
<p>Supported DB Engines: (You must have the command line clients installed)</p>

<ul>
<li>Oracle</li>
<li>MySQL</li>
<li>PostgreSQL</li>
</ul>
<br>
<h3>
<a id="requirements" class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h3>

<p>Software:</p>

<ul>
<li>Linux</li>
<li>Python (tested on 2.6 and 2.7)</li>
<li>A database engine, in the examples I use MySQL</li>
<li>Redis (for store information about the active connections)</li>
</ul>

<p>Python Modules:</p>

<ul>
<li>Django (Tested with 1.6)</li>
<li>django-bootstrap3</li>
<li>django-selectable</li>
<li>django-widget-tweaks</li>
<li>paramiko</li>
<li>urwid</li>
<li>redis</li>
<li>pytz</li>
<li>(The databse engine module of your choice)</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/aenima-x/BlackHole">Blackhole</a> is maintained by <a href="https://github.com/aenima-x">aenima-x</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

